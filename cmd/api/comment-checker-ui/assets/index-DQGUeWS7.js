var gt=Object.defineProperty;var _t=(n,e,s)=>e in n?gt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var Be=(n,e,s)=>(_t(n,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const _ of f.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function s(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerPolicy&&(f.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?f.credentials="include":a.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function r(a){if(a.ep)return;a.ep=!0;const f=s(a);fetch(a.href,f)}})();function we(){}function dt(n){return n()}function Je(){return Object.create(null)}function Se(n){n.forEach(dt)}function ht(n){return typeof n=="function"}function bt(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function vt(n){return Object.keys(n).length===0}function L(n,e){n.appendChild(e)}function C(n,e,s){n.insertBefore(e,s||null)}function y(n){n.parentNode&&n.parentNode.removeChild(n)}function We(n,e){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(e)}function T(n){return document.createElement(n)}function ne(n){return document.createTextNode(n)}function j(){return ne(" ")}function kt(){return ne("")}function de(n,e,s,r){return n.addEventListener(e,s,r),()=>n.removeEventListener(e,s,r)}function z(n,e,s){s==null?n.removeAttribute(e):n.getAttribute(e)!==s&&n.setAttribute(e,s)}function yt(n){return Array.from(n.childNodes)}function ce(n,e){e=""+e,n.data!==e&&(n.data=e)}let Ve;function Pe(n){Ve=n}const Fe=[],Ge=[];let Ne=[];const Qe=[],Ct=Promise.resolve();let ze=!1;function wt(){ze||(ze=!0,Ct.then(pt))}function qe(n){Ne.push(n)}const He=new Set;let De=0;function pt(){if(De!==0)return;const n=Ve;do{try{for(;De<Fe.length;){const e=Fe[De];De++,Pe(e),Et(e.$$)}}catch(e){throw Fe.length=0,De=0,e}for(Pe(null),Fe.length=0,De=0;Ge.length;)Ge.pop()();for(let e=0;e<Ne.length;e+=1){const s=Ne[e];He.has(s)||(He.add(s),s())}Ne.length=0}while(Fe.length);for(;Qe.length;)Qe.pop()();ze=!1,He.clear(),Pe(n)}function Et(n){if(n.fragment!==null){n.update(),Se(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(qe)}}function Rt(n){const e=[],s=[];Ne.forEach(r=>n.indexOf(r)===-1?e.push(r):s.push(r)),s.forEach(r=>r()),Ne=e}const Ot=new Set;function St(n,e){n&&n.i&&(Ot.delete(n),n.i(e))}function Me(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function At(n,e,s){const{fragment:r,after_update:a}=n.$$;r&&r.m(e,s),qe(()=>{const f=n.$$.on_mount.map(dt).filter(ht);n.$$.on_destroy?n.$$.on_destroy.push(...f):Se(f),n.$$.on_mount=[]}),a.forEach(qe)}function Tt(n,e){const s=n.$$;s.fragment!==null&&(Rt(s.after_update),Se(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function Lt(n,e){n.$$.dirty[0]===-1&&(Fe.push(n),wt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function It(n,e,s,r,a,f,_=null,d=[-1]){const o=Ve;Pe(n);const u=n.$$={fragment:null,ctx:[],props:f,update:we,not_equal:a,bound:Je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:Je(),dirty:d,skip_bound:!1,root:e.target||o.$$.root};_&&_(u.root);let p=!1;if(u.ctx=s?s(n,e.props||{},(g,h,...R)=>{const E=R.length?R[0]:h;return u.ctx&&a(u.ctx[g],u.ctx[g]=E)&&(!u.skip_bound&&u.bound[g]&&u.bound[g](E),p&&Lt(n,g)),h}):[],u.update(),p=!0,Se(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const g=yt(e.target);u.fragment&&u.fragment.l(g),g.forEach(y)}else u.fragment&&u.fragment.c();e.intro&&St(n.$$.fragment),At(n,e.target,e.anchor),pt()}Pe(o)}class Dt{constructor(){Be(this,"$$");Be(this,"$$set")}$destroy(){Tt(this,1),this.$destroy=we}$on(e,s){if(!ht(s))return we;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(s),()=>{const a=r.indexOf(s);a!==-1&&r.splice(a,1)}}$set(e){this.$$set&&!vt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ft="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ft);var Nt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var mt={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(n,e){(function(s,r){n.exports=r()})(Nt,function s(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},a=!r.document&&!!r.postMessage,f=r.IS_PAPA_WORKER||!1,_={},d=0,o={parse:function(i,t){var l=(t=t||{}).dynamicTyping||!1;if(K(l)&&(t.dynamicTypingFunction=l,l={}),t.dynamicTyping=l,t.transform=!!K(t.transform)&&t.transform,t.worker&&o.WORKERS_SUPPORTED){var v=function(){if(!o.WORKERS_SUPPORTED)return!1;var I=(k=r.URL||r.webkitURL||null,c=s.toString(),o.BLOB_URL||(o.BLOB_URL=k.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",c,")();"],{type:"text/javascript"})))),B=new r.Worker(I),k,c;return B.onmessage=F,B.id=d++,_[B.id]=B}();return v.userStep=t.step,v.userChunk=t.chunk,v.userComplete=t.complete,v.userError=t.error,t.step=K(t.step),t.chunk=K(t.chunk),t.complete=K(t.complete),t.error=K(t.error),delete t.worker,void v.postMessage({input:i,config:t,workerId:v.id})}var w=null;return o.NODE_STREAM_INPUT,typeof i=="string"?(i=function(I){return I.charCodeAt(0)===65279?I.slice(1):I}(i),w=t.download?new g(t):new R(t)):i.readable===!0&&K(i.read)&&K(i.on)?w=new E(t):(r.File&&i instanceof File||i instanceof Object)&&(w=new h(t)),w.stream(i)},unparse:function(i,t){var l=!1,v=!0,w=",",I=`\r
`,B='"',k=B+B,c=!1,m=null,N=!1;(function(){if(typeof t=="object"){if(typeof t.delimiter!="string"||o.BAD_DELIMITERS.filter(function(O){return t.delimiter.indexOf(O)!==-1}).length||(w=t.delimiter),(typeof t.quotes=="boolean"||typeof t.quotes=="function"||Array.isArray(t.quotes))&&(l=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(c=t.skipEmptyLines),typeof t.newline=="string"&&(I=t.newline),typeof t.quoteChar=="string"&&(B=t.quoteChar),typeof t.header=="boolean"&&(v=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");m=t.columns}t.escapeChar!==void 0&&(k=t.escapeChar+B),(typeof t.escapeFormulae=="boolean"||t.escapeFormulae instanceof RegExp)&&(N=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var b=new RegExp(P(B),"g");if(typeof i=="string"&&(i=JSON.parse(i)),Array.isArray(i)){if(!i.length||Array.isArray(i[0]))return q(null,i,c);if(typeof i[0]=="object")return q(m||Object.keys(i[0]),i,c)}else if(typeof i=="object")return typeof i.data=="string"&&(i.data=JSON.parse(i.data)),Array.isArray(i.data)&&(i.fields||(i.fields=i.meta&&i.meta.fields||m),i.fields||(i.fields=Array.isArray(i.data[0])?i.fields:typeof i.data[0]=="object"?Object.keys(i.data[0]):[]),Array.isArray(i.data[0])||typeof i.data[0]=="object"||(i.data=[i.data])),q(i.fields||[],i.data||[],c);throw new Error("Unable to serialize unrecognized input");function q(O,G,le){var Z="";typeof O=="string"&&(O=JSON.parse(O)),typeof G=="string"&&(G=JSON.parse(G));var oe=Array.isArray(O)&&0<O.length,ie=!Array.isArray(G[0]);if(oe&&v){for(var se=0;se<O.length;se++)0<se&&(Z+=w),Z+=ee(O[se],se);0<G.length&&(Z+=I)}for(var D=0;D<G.length;D++){var W=oe?O.length:G[D].length,Q=!1,te=oe?Object.keys(G[D]).length===0:G[D].length===0;if(le&&!oe&&(Q=le==="greedy"?G[D].join("").trim()==="":G[D].length===1&&G[D][0].length===0),le==="greedy"&&oe){for(var x=[],ae=0;ae<W;ae++){var X=ie?O[ae]:ae;x.push(G[D][X])}Q=x.join("").trim()===""}if(!Q){for(var J=0;J<W;J++){0<J&&!te&&(Z+=w);var _e=oe&&ie?O[J]:J;Z+=ee(G[D][_e],J)}D<G.length-1&&(!le||0<W&&!te)&&(Z+=I)}}return Z}function ee(O,G){if(O==null)return"";if(O.constructor===Date)return JSON.stringify(O).slice(1,25);var le=!1;N&&typeof O=="string"&&N.test(O)&&(O="'"+O,le=!0);var Z=O.toString().replace(b,k);return(le=le||l===!0||typeof l=="function"&&l(O,G)||Array.isArray(l)&&l[G]||function(oe,ie){for(var se=0;se<ie.length;se++)if(-1<oe.indexOf(ie[se]))return!0;return!1}(Z,o.BAD_DELIMITERS)||-1<Z.indexOf(w)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?B+Z+B:Z}}};if(o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!a&&!!r.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=S,o.ParserHandle=H,o.NetworkStreamer=g,o.FileStreamer=h,o.StringStreamer=R,o.ReadableStreamStreamer=E,r.jQuery){var u=r.jQuery;u.fn.parse=function(i){var t=i.config||{},l=[];return this.each(function(I){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var B=0;B<this.files.length;B++)l.push({file:this.files[B],inputElem:this,instanceConfig:u.extend({},t)})}),v(),this;function v(){if(l.length!==0){var I,B,k,c,m=l[0];if(K(i.before)){var N=i.before(m.file,m.inputElem);if(typeof N=="object"){if(N.action==="abort")return I="AbortError",B=m.file,k=m.inputElem,c=N.reason,void(K(i.error)&&i.error({name:I},B,k,c));if(N.action==="skip")return void w();typeof N.config=="object"&&(m.instanceConfig=u.extend(m.instanceConfig,N.config))}else if(N==="skip")return void w()}var b=m.instanceConfig.complete;m.instanceConfig.complete=function(q){K(b)&&b(q,m.file,m.inputElem),w()},o.parse(m.file,m.instanceConfig)}else K(i.complete)&&i.complete()}function w(){l.splice(0,1),v()}}}function p(i){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var l=M(t);l.chunkSize=parseInt(l.chunkSize),t.step||t.chunk||(l.chunkSize=null),this._handle=new H(l),(this._handle.streamer=this)._config=l}).call(this,i),this.parseChunk=function(t,l){if(this.isFirstChunk&&K(this._config.beforeFirstChunk)){var v=this._config.beforeFirstChunk(t);v!==void 0&&(t=v)}this.isFirstChunk=!1,this._halted=!1;var w=this._partialLine+t;this._partialLine="";var I=this._handle.parse(w,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var B=I.meta.cursor;this._finished||(this._partialLine=w.substring(B-this._baseIndex),this._baseIndex=B),I&&I.data&&(this._rowCount+=I.data.length);var k=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(f)r.postMessage({results:I,workerId:o.WORKER_ID,finished:k});else if(K(this._config.chunk)&&!l){if(this._config.chunk(I,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);I=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(I.data),this._completeResults.errors=this._completeResults.errors.concat(I.errors),this._completeResults.meta=I.meta),this._completed||!k||!K(this._config.complete)||I&&I.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),k||I&&I.meta.paused||this._nextChunk(),I}this._halted=!0},this._sendError=function(t){K(this._config.error)?this._config.error(t):f&&this._config.error&&r.postMessage({workerId:o.WORKER_ID,error:t,finished:!1})}}function g(i){var t;(i=i||{}).chunkSize||(i.chunkSize=o.RemoteChunkSize),p.call(this,i),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(l){this._input=l,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),a||(t.onload=re(this._chunkLoaded,this),t.onerror=re(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var l=this._config.downloadRequestHeaders;for(var v in l)t.setRequestHeader(v,l[v])}if(this._config.chunkSize){var w=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+w)}try{t.send(this._config.downloadRequestBody)}catch(I){this._chunkError(I.message)}a&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(l){var v=l.getResponseHeader("Content-Range");return v===null?-1:parseInt(v.substring(v.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(l){var v=t.statusText||l;this._sendError(new Error(v))}}function h(i){var t,l;(i=i||{}).chunkSize||(i.chunkSize=o.LocalChunkSize),p.call(this,i);var v=typeof FileReader<"u";this.stream=function(w){this._input=w,l=w.slice||w.webkitSlice||w.mozSlice,v?((t=new FileReader).onload=re(this._chunkLoaded,this),t.onerror=re(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var w=this._input;if(this._config.chunkSize){var I=Math.min(this._start+this._config.chunkSize,this._input.size);w=l.call(w,this._start,I)}var B=t.readAsText(w,this._config.encoding);v||this._chunkLoaded({target:{result:B}})},this._chunkLoaded=function(w){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(w.target.result)},this._chunkError=function(){this._sendError(t.error)}}function R(i){var t;p.call(this,i=i||{}),this.stream=function(l){return t=l,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var l,v=this._config.chunkSize;return v?(l=t.substring(0,v),t=t.substring(v)):(l=t,t=""),this._finished=!t,this.parseChunk(l)}}}function E(i){p.call(this,i=i||{});var t=[],l=!0,v=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(w){this._input=w,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){v&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):l=!0},this._streamData=re(function(w){try{t.push(typeof w=="string"?w:w.toString(this._config.encoding)),l&&(l=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(I){this._streamError(I)}},this),this._streamError=re(function(w){this._streamCleanUp(),this._sendError(w)},this),this._streamEnd=re(function(){this._streamCleanUp(),v=!0,this._streamData("")},this),this._streamCleanUp=re(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function H(i){var t,l,v,w=Math.pow(2,53),I=-w,B=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,k=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,m=0,N=0,b=!1,q=!1,ee=[],O={data:[],errors:[],meta:{}};if(K(i.step)){var G=i.step;i.step=function(D){if(O=D,oe())Z();else{if(Z(),O.data.length===0)return;m+=D.data.length,i.preview&&m>i.preview?l.abort():(O.data=O.data[0],G(O,c))}}}function le(D){return i.skipEmptyLines==="greedy"?D.join("").trim()==="":D.length===1&&D[0].length===0}function Z(){return O&&v&&(se("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),v=!1),i.skipEmptyLines&&(O.data=O.data.filter(function(D){return!le(D)})),oe()&&function(){if(!O)return;function D(Q,te){K(i.transformHeader)&&(Q=i.transformHeader(Q,te)),ee.push(Q)}if(Array.isArray(O.data[0])){for(var W=0;oe()&&W<O.data.length;W++)O.data[W].forEach(D);O.data.splice(0,1)}else O.data.forEach(D)}(),function(){if(!O||!i.header&&!i.dynamicTyping&&!i.transform)return O;function D(Q,te){var x,ae=i.header?{}:[];for(x=0;x<Q.length;x++){var X=x,J=Q[x];i.header&&(X=x>=ee.length?"__parsed_extra":ee[x]),i.transform&&(J=i.transform(J,X)),J=ie(X,J),X==="__parsed_extra"?(ae[X]=ae[X]||[],ae[X].push(J)):ae[X]=J}return i.header&&(x>ee.length?se("FieldMismatch","TooManyFields","Too many fields: expected "+ee.length+" fields but parsed "+x,N+te):x<ee.length&&se("FieldMismatch","TooFewFields","Too few fields: expected "+ee.length+" fields but parsed "+x,N+te)),ae}var W=1;return!O.data.length||Array.isArray(O.data[0])?(O.data=O.data.map(D),W=O.data.length):O.data=D(O.data,0),i.header&&O.meta&&(O.meta.fields=ee),N+=W,O}()}function oe(){return i.header&&ee.length===0}function ie(D,W){return Q=D,i.dynamicTypingFunction&&i.dynamicTyping[Q]===void 0&&(i.dynamicTyping[Q]=i.dynamicTypingFunction(Q)),(i.dynamicTyping[Q]||i.dynamicTyping)===!0?W==="true"||W==="TRUE"||W!=="false"&&W!=="FALSE"&&(function(te){if(B.test(te)){var x=parseFloat(te);if(I<x&&x<w)return!0}return!1}(W)?parseFloat(W):k.test(W)?new Date(W):W===""?null:W):W;var Q}function se(D,W,Q,te){var x={type:D,code:W,message:Q};te!==void 0&&(x.row=te),O.errors.push(x)}this.parse=function(D,W,Q){var te=i.quoteChar||'"';if(i.newline||(i.newline=function(X,J){X=X.substring(0,1048576);var _e=new RegExp(P(J)+"([^]*?)"+P(J),"gm"),he=(X=X.replace(_e,"")).split("\r"),be=X.split(`
`),ke=1<be.length&&be[0].length<he[0].length;if(he.length===1||ke)return`
`;for(var pe=0,Y=0;Y<he.length;Y++)he[Y][0]===`
`&&pe++;return pe>=he.length/2?`\r
`:"\r"}(D,te)),v=!1,i.delimiter)K(i.delimiter)&&(i.delimiter=i.delimiter(D),O.meta.delimiter=i.delimiter);else{var x=function(X,J,_e,he,be){var ke,pe,Y,$;be=be||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Ae=0;Ae<be.length;Ae++){var V=be[Ae],Ie=0,ye=0,Te=0;Y=void 0;for(var Ee=new S({comments:he,delimiter:V,newline:J,preview:10}).parse(X),Re=0;Re<Ee.data.length;Re++)if(_e&&le(Ee.data[Re]))Te++;else{var Oe=Ee.data[Re].length;ye+=Oe,Y!==void 0?0<Oe&&(Ie+=Math.abs(Oe-Y),Y=Oe):Y=Oe}0<Ee.data.length&&(ye/=Ee.data.length-Te),(pe===void 0||Ie<=pe)&&($===void 0||$<ye)&&1.99<ye&&(pe=Ie,ke=V,$=ye)}return{successful:!!(i.delimiter=ke),bestDelimiter:ke}}(D,i.newline,i.skipEmptyLines,i.comments,i.delimitersToGuess);x.successful?i.delimiter=x.bestDelimiter:(v=!0,i.delimiter=o.DefaultDelimiter),O.meta.delimiter=i.delimiter}var ae=M(i);return i.preview&&i.header&&ae.preview++,t=D,l=new S(ae),O=l.parse(t,W,Q),Z(),b?{meta:{paused:!0}}:O||{meta:{paused:!1}}},this.paused=function(){return b},this.pause=function(){b=!0,l.abort(),t=K(i.chunk)?"":t.substring(l.getCharIndex())},this.resume=function(){c.streamer._halted?(b=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return q},this.abort=function(){q=!0,l.abort(),O.meta.aborted=!0,K(i.complete)&&i.complete(O),t=""}}function P(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function S(i){var t,l=(i=i||{}).delimiter,v=i.newline,w=i.comments,I=i.step,B=i.preview,k=i.fastMode,c=t=i.quoteChar===void 0||i.quoteChar===null?'"':i.quoteChar;if(i.escapeChar!==void 0&&(c=i.escapeChar),(typeof l!="string"||-1<o.BAD_DELIMITERS.indexOf(l))&&(l=","),w===l)throw new Error("Comment character same as delimiter");w===!0?w="#":(typeof w!="string"||-1<o.BAD_DELIMITERS.indexOf(w))&&(w=!1),v!==`
`&&v!=="\r"&&v!==`\r
`&&(v=`
`);var m=0,N=!1;this.parse=function(b,q,ee){if(typeof b!="string")throw new Error("Input must be a string");var O=b.length,G=l.length,le=v.length,Z=w.length,oe=K(I),ie=[],se=[],D=[],W=m=0;if(!b)return me();if(i.header&&!q){var Q=b.split(v)[0].split(l),te=[],x={},ae=!1;for(var X in Q){var J=Q[X];K(i.transformHeader)&&(J=i.transformHeader(J,X));var _e=J,he=x[J]||0;for(0<he&&(ae=!0,_e=J+"_"+he),x[J]=he+1;te.includes(_e);)_e=_e+"_"+he;te.push(_e)}if(ae){var be=b.split(v);be[0]=te.join(l),b=be.join(v)}}if(k||k!==!1&&b.indexOf(t)===-1){for(var ke=b.split(v),pe=0;pe<ke.length;pe++){if(D=ke[pe],m+=D.length,pe!==ke.length-1)m+=v.length;else if(ee)return me();if(!w||D.substring(0,Z)!==w){if(oe){if(ie=[],Te(D.split(l)),je(),N)return me()}else Te(D.split(l));if(B&&B<=pe)return ie=ie.slice(0,B),me(!0)}}return me()}for(var Y=b.indexOf(l,m),$=b.indexOf(v,m),Ae=new RegExp(P(c)+P(t),"g"),V=b.indexOf(t,m);;)if(b[m]!==t)if(w&&D.length===0&&b.substring(m,m+Z)===w){if($===-1)return me();m=$+le,$=b.indexOf(v,m),Y=b.indexOf(l,m)}else if(Y!==-1&&(Y<$||$===-1))D.push(b.substring(m,Y)),m=Y+G,Y=b.indexOf(l,m);else{if($===-1)break;if(D.push(b.substring(m,$)),Oe($+le),oe&&(je(),N))return me();if(B&&ie.length>=B)return me(!0)}else for(V=m,m++;;){if((V=b.indexOf(t,V+1))===-1)return ee||se.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ie.length,index:m}),Re();if(V===O-1)return Re(b.substring(m,V).replace(Ae,t));if(t!==c||b[V+1]!==c){if(t===c||V===0||b[V-1]!==c){Y!==-1&&Y<V+1&&(Y=b.indexOf(l,V+1)),$!==-1&&$<V+1&&($=b.indexOf(v,V+1));var Ie=Ee($===-1?Y:Math.min(Y,$));if(b.substr(V+1+Ie,G)===l){D.push(b.substring(m,V).replace(Ae,t)),b[m=V+1+Ie+G]!==t&&(V=b.indexOf(t,m)),Y=b.indexOf(l,m),$=b.indexOf(v,m);break}var ye=Ee($);if(b.substring(V+1+ye,V+1+ye+le)===v){if(D.push(b.substring(m,V).replace(Ae,t)),Oe(V+1+ye+le),Y=b.indexOf(l,m),V=b.indexOf(t,m),oe&&(je(),N))return me();if(B&&ie.length>=B)return me(!0);break}se.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ie.length,index:m}),V++}}else V++}return Re();function Te(ge){ie.push(ge),W=m}function Ee(ge){var xe=0;if(ge!==-1){var Ue=b.substring(V+1,ge);Ue&&Ue.trim()===""&&(xe=Ue.length)}return xe}function Re(ge){return ee||(ge===void 0&&(ge=b.substring(m)),D.push(ge),m=O,Te(D),oe&&je()),me()}function Oe(ge){m=ge,Te(D),D=[],$=b.indexOf(v,m)}function me(ge){return{data:ie,errors:se,meta:{delimiter:l,linebreak:v,aborted:N,truncated:!!ge,cursor:W+(q||0)}}}function je(){I(me()),ie=[],se=[]}},this.abort=function(){N=!0},this.getCharIndex=function(){return m}}function F(i){var t=i.data,l=_[t.workerId],v=!1;if(t.error)l.userError(t.error,t.file);else if(t.results&&t.results.data){var w={abort:function(){v=!0,U(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:A,resume:A};if(K(l.userStep)){for(var I=0;I<t.results.data.length&&(l.userStep({data:t.results.data[I],errors:t.results.errors,meta:t.results.meta},w),!v);I++);delete t.results}else K(l.userChunk)&&(l.userChunk(t.results,w,t.file),delete t.results)}t.finished&&!v&&U(t.workerId,t.results)}function U(i,t){var l=_[i];K(l.userComplete)&&l.userComplete(t),l.terminate(),delete _[i]}function A(){throw new Error("Not implemented.")}function M(i){if(typeof i!="object"||i===null)return i;var t=Array.isArray(i)?[]:{};for(var l in i)t[l]=M(i[l]);return t}function re(i,t){return function(){i.apply(t,arguments)}}function K(i){return typeof i=="function"}return f&&(r.onmessage=function(i){var t=i.data;if(o.WORKER_ID===void 0&&t&&(o.WORKER_ID=t.workerId),typeof t.input=="string")r.postMessage({workerId:o.WORKER_ID,results:o.parse(t.input,t.config),finished:!0});else if(r.File&&t.input instanceof File||t.input instanceof Object){var l=o.parse(t.input,t.config);l&&r.postMessage({workerId:o.WORKER_ID,results:l,finished:!0})}}),(g.prototype=Object.create(p.prototype)).constructor=g,(h.prototype=Object.create(p.prototype)).constructor=h,(R.prototype=Object.create(R.prototype)).constructor=R,(E.prototype=Object.create(p.prototype)).constructor=E,o})})(mt);var Pt=mt.exports;const Ye=Mt(Pt);function Ze(n,e,s){const r=n.slice();return r[33]=e[s],r}function Xe(n,e,s){const r=n.slice();return r[36]=e[s],r}function $e(n,e,s){const r=n.slice();return r[39]=e[s],r}function et(n){let e,s,r,a,f,_,d,o;return{c(){e=T("h2"),e.textContent="A tool to check your Kaiārahi comments.",s=j(),r=T("div"),a=T("div"),a.innerHTML='<h2>Upload Comments from KAMAR</h2> <p class="svelte-1itnntl">Export a .csv from PowerBI to process here.<br/> <strong>NOTE:</strong> this service is configured for Wakatipu High School specifically, and may not work with data from other schools.</p>',f=j(),_=T("div"),_.textContent="BACK",z(a,"class","tool-selector-button svelte-1itnntl"),z(r,"class","tool-selector-button-container svelte-1itnntl"),z(_,"class","styled-button back-button svelte-1itnntl")},m(u,p){C(u,e,p),C(u,s,p),C(u,r,p),L(r,a),C(u,f,p),C(u,_,p),d||(o=[de(a,"click",n[13]),de(_,"click",n[14])],d=!0)},p:we,d(u){u&&(y(e),y(s),y(r),y(f),y(_)),d=!1,Se(o)}}}function tt(n){let e,s,r,a,f,_,d,o,u,p,g,h,R,E,H,P,S,F,U=n[5]&&nt(n);return{c(){e=T("h3"),e.textContent="CSV format:",s=j(),r=T("table"),r.innerHTML='<thead><tr><th class="svelte-1itnntl">First Name</th> <th class="svelte-1itnntl">Last Name</th> <th class="svelte-1itnntl">Student ID</th> <th class="svelte-1itnntl">Current Year Level</th> <th class="svelte-1itnntl">Ako Group</th> <th class="svelte-1itnntl">Stu_Gender_Code</th> <th class="svelte-1itnntl">max comment</th></tr></thead> <tbody><tr><td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td></tr></tbody>',a=j(),f=T("p"),f.textContent='In order to get this CSV, open the PowerBI report called "Kaiārahi Comment Checking" - the table there should reflect the columns listed above. Make sure the correct reports design(s) are selected, eg. probably 3080 for Senior End of Year, 3072 and 3073 for Senior and Junior Midyear etc.',_=j(),d=T("p"),d.innerHTML="<strong>This app will not work without a CSV file containing the above columns</strong>.",o=j(),u=T("input"),p=j(),U&&U.c(),g=j(),h=T("br"),R=j(),E=T("div"),E.innerHTML=`You can find the report design number by going to <strong>Reporting --&gt; Progress Reports</strong> in KAMAR. Select the Report Design that will contain the comment that you want to check, eg. &quot;Junior End of Year&quot;.<br/><br/>
      Click on the (i) button in the top right. Take note of the Report Design ID - put this number into the &quot;Report_Ref&quot; filter on the Kaiārahi Comment Checking page on PowerBI.`,H=j(),P=T("div"),P.textContent="BACK",z(f,"class","svelte-1itnntl"),z(d,"class","svelte-1itnntl"),z(u,"type","file"),z(u,"name","csv-input"),z(u,"id","csv-input"),z(u,"accept",".csv"),z(u,"class","svelte-1itnntl"),z(E,"class","info-container svelte-1itnntl"),z(P,"class","styled-button back-button svelte-1itnntl")},m(A,M){C(A,e,M),C(A,s,M),C(A,r,M),C(A,a,M),C(A,f,M),C(A,_,M),C(A,d,M),C(A,o,M),C(A,u,M),C(A,p,M),U&&U.m(A,M),C(A,g,M),C(A,h,M),C(A,R,M),C(A,E,M),C(A,H,M),C(A,P,M),S||(F=[de(u,"change",n[15]),de(P,"click",n[12])],S=!0)},p(A,M){A[5]?U?U.p(A,M):(U=nt(A),U.c(),U.m(g.parentNode,g)):U&&(U.d(1),U=null)},d(A){A&&(y(e),y(s),y(r),y(a),y(f),y(_),y(d),y(o),y(u),y(p),y(g),y(h),y(R),y(E),y(H),y(P)),U&&U.d(A),S=!1,Se(F)}}}function nt(n){let e,s,r,a,f,_,d,o;return{c(){e=T("p"),s=j(),r=T("div"),a=T("input"),f=j(),_=T("input"),z(e,"class","svelte-1itnntl"),z(a,"type","button"),a.value="Process Individually",z(_,"type","button"),_.value="Process All",z(r,"class","submit-options")},m(u,p){C(u,e,p),e.innerHTML=n[5],C(u,s,p),C(u,r,p),L(r,a),L(r,f),L(r,_),d||(o=[de(a,"click",n[7]),de(_,"click",n[8])],d=!0)},p(u,p){p[0]&32&&(e.innerHTML=u[5])},d(u){u&&(y(e),y(s),y(r)),d=!1,Se(o)}}}function it(n){let e,s,r,a,f;return{c(){e=T("p"),e.textContent="This tool is still being put together.",s=j(),r=T("div"),r.textContent="BACK",z(e,"class","svelte-1itnntl"),z(r,"class","styled-button back-button svelte-1itnntl")},m(_,d){C(_,e,d),C(_,s,d),C(_,r,d),a||(f=de(r,"click",n[12]),a=!0)},p:we,d(_){_&&(y(e),y(s),y(r)),a=!1,f()}}}function st(n){let e;return{c(){e=T("h2"),e.textContent="LOADING..."},m(s,r){C(s,e,r)},d(s){s&&y(e)}}}function rt(n){let e;function s(f,_){return f[6]>=0&&f[6]<f[2].data.length?Ut:jt}let r=s(n),a=r(n);return{c(){a.c(),e=kt()},m(f,_){a.m(f,_),C(f,e,_)},p(f,_){r===(r=s(f))&&a?a.p(f,_):(a.d(1),a=r(f),a&&(a.c(),a.m(e.parentNode,e)))},d(f){f&&y(e),a.d(f)}}}function jt(n){let e,s,r;return{c(){e=T("div"),e.textContent="DONE",z(e,"class","styled-button back-button svelte-1itnntl")},m(a,f){C(a,e,f),s||(r=de(e,"click",n[12]),s=!0)},p:we,d(a){a&&y(e),s=!1,r()}}}function Ut(n){let e,s,r,a=n[2].data[n[6]][ve]+"",f,_,d=n[2].data[n[6]][Ce]+"",o,u,p,g,h,R=n[2].data[n[6]][fe]+"",E,H,P,S,F,U,A,M=n[2].data[n[6]][fe].length>800&&ot(n);function re(t,l){return t[2].data[t[6]].suggestions.length>0?Ht:Bt}let K=re(n),i=K(n);return{c(){e=T("h2"),e.textContent="Student Name:",s=j(),r=T("p"),f=ne(a),_=j(),o=ne(d),u=j(),p=T("h2"),p.textContent="Original Comment:",g=j(),h=T("p"),E=ne(R),H=j(),M&&M.c(),P=j(),i.c(),S=j(),F=T("div"),F.textContent="NEXT",z(r,"class","svelte-1itnntl"),z(h,"class","svelte-1itnntl"),z(F,"class","styled-button next-button svelte-1itnntl")},m(t,l){C(t,e,l),C(t,s,l),C(t,r,l),L(r,f),L(r,_),L(r,o),C(t,u,l),C(t,p,l),C(t,g,l),C(t,h,l),L(h,E),C(t,H,l),M&&M.m(t,l),C(t,P,l),i.m(t,l),C(t,S,l),C(t,F,l),U||(A=de(F,"click",n[11]),U=!0)},p(t,l){l[0]&68&&a!==(a=t[2].data[t[6]][ve]+"")&&ce(f,a),l[0]&68&&d!==(d=t[2].data[t[6]][Ce]+"")&&ce(o,d),l[0]&68&&R!==(R=t[2].data[t[6]][fe]+"")&&ce(E,R),t[2].data[t[6]][fe].length>800?M?M.p(t,l):(M=ot(t),M.c(),M.m(P.parentNode,P)):M&&(M.d(1),M=null),K===(K=re(t))&&i?i.p(t,l):(i.d(1),i=K(t),i&&(i.c(),i.m(S.parentNode,S)))},d(t){t&&(y(e),y(s),y(r),y(u),y(p),y(g),y(h),y(H),y(P),y(S),y(F)),M&&M.d(t),i.d(t),U=!1,A()}}}function ot(n){let e,s,r=n[2].data[n[6]][fe].length+"",a,f;return{c(){e=T("p"),s=ne("This comment contains "),a=ne(r),f=ne(" characters - the maximum is 800. Please revise your comment, or part of it will be cut off on the report!"),z(e,"class","error-text svelte-1itnntl")},m(_,d){C(_,e,d),L(e,s),L(e,a),L(e,f)},p(_,d){d[0]&68&&r!==(r=_[2].data[_[6]][fe].length+"")&&ce(a,r)},d(_){_&&y(e)}}}function Bt(n){let e;return{c(){e=T("p"),e.textContent="The words in this comment passed all tests.",z(e,"class","svelte-1itnntl")},m(s,r){C(s,e,r)},p:we,d(s){s&&y(e)}}}function Ht(n){let e,s,r,a,f,_,d=n[2].data[n[6]].commentFragments.join("")+"",o,u,p=Me(n[2].data[n[6]].suggestions),g=[];for(let h=0;h<p.length;h+=1)g[h]=lt($e(n,p,h));return{c(){e=T("h2"),e.textContent="Suggestions:",s=j();for(let h=0;h<g.length;h+=1)g[h].c();r=j(),a=T("h2"),a.textContent="Revised Comment:",f=j(),_=T("p"),o=j(),u=T("p"),u.textContent="Feel free to copy and paste this comment into KAMAR :D",z(_,"class","svelte-1itnntl"),z(u,"class","svelte-1itnntl")},m(h,R){C(h,e,R),C(h,s,R);for(let E=0;E<g.length;E+=1)g[E]&&g[E].m(h,R);C(h,r,R),C(h,a,R),C(h,f,R),C(h,_,R),_.innerHTML=d,C(h,o,R),C(h,u,R)},p(h,R){if(R[0]&68){p=Me(h[2].data[h[6]].suggestions);let E;for(E=0;E<p.length;E+=1){const H=$e(h,p,E);g[E]?g[E].p(H,R):(g[E]=lt(H),g[E].c(),g[E].m(r.parentNode,r))}for(;E<g.length;E+=1)g[E].d(1);g.length=p.length}R[0]&68&&d!==(d=h[2].data[h[6]].commentFragments.join("")+"")&&(_.innerHTML=d)},d(h){h&&(y(e),y(s),y(r),y(a),y(f),y(_),y(o),y(u)),We(g,h)}}}function lt(n){let e,s=n[39].suggestion+"",r;return{c(){e=T("p"),r=ne(s),z(e,"class","svelte-1itnntl")},m(a,f){C(a,e,f),L(e,r)},p(a,f){f[0]&68&&s!==(s=a[39].suggestion+"")&&ce(r,s)},d(a){a&&y(e)}}}function at(n){let e,s,r,a,f,_,d,o,u,p,g,h,R,E,H,P=Me(Object.values(n[3])),S=[];for(let F=0;F<P.length;F+=1)S[F]=ut(Xe(n,P,F));return{c(){e=T("h2"),e.textContent="REPORT",s=j(),r=T("div"),a=T("input"),f=j(),_=T("input"),d=j(),o=T("table"),u=T("thead"),u.innerHTML='<tr><th class="svelte-1itnntl">Teacher</th> <th class="svelte-1itnntl"># of Students</th> <th class="svelte-1itnntl">Comment Missing</th> <th class="svelte-1itnntl">% Complete</th> <th class="svelte-1itnntl">Too Long</th> <th class="svelte-1itnntl">Missing Name</th> <th class="svelte-1itnntl">Macron Suggestions</th> <th class="svelte-1itnntl">Incorrect Pronoun</th></tr>',p=j(),g=T("tbody");for(let F=0;F<S.length;F+=1)S[F].c();h=j(),R=T("div"),R.textContent="DONE",z(a,"type","button"),a.value="Download CSV",z(_,"type","button"),_.value="Download JSON",z(R,"class","styled-button back-button svelte-1itnntl")},m(F,U){C(F,e,U),C(F,s,U),C(F,r,U),L(r,a),L(r,f),L(r,_),C(F,d,U),C(F,o,U),L(o,u),L(o,p),L(o,g);for(let A=0;A<S.length;A+=1)S[A]&&S[A].m(g,null);C(F,h,U),C(F,R,U),E||(H=[de(a,"click",n[9]),de(_,"click",n[10]),de(R,"click",n[12])],E=!0)},p(F,U){if(U[0]&8){P=Me(Object.values(F[3]));let A;for(A=0;A<P.length;A+=1){const M=Xe(F,P,A);S[A]?S[A].p(M,U):(S[A]=ut(M),S[A].c(),S[A].m(g,null))}for(;A<S.length;A+=1)S[A].d(1);S.length=P.length}},d(F){F&&(y(e),y(s),y(r),y(d),y(o),y(h),y(R)),We(S,F),E=!1,Se(H)}}}function ut(n){let e,s,r=n[36].code+"",a,f,_,d=n[36].total+"",o,u,p,g=n[36].empty+"",h,R,E,H=n[36].percentComplete+"",P,S,F,U,A=n[36].tooLong+"",M,re,K,i=n[36].names+"",t,l,v,w=n[36].macrons+"",I,B,k,c=n[36].pronouns+"",m,N;return{c(){e=T("tr"),s=T("td"),a=ne(r),f=j(),_=T("td"),o=ne(d),u=j(),p=T("td"),h=ne(g),R=j(),E=T("td"),P=ne(H),S=ne("%"),F=j(),U=T("td"),M=ne(A),re=j(),K=T("td"),t=ne(i),l=j(),v=T("td"),I=ne(w),B=j(),k=T("td"),m=ne(c),N=j()},m(b,q){C(b,e,q),L(e,s),L(s,a),L(e,f),L(e,_),L(_,o),L(e,u),L(e,p),L(p,h),L(e,R),L(e,E),L(E,P),L(E,S),L(e,F),L(e,U),L(U,M),L(e,re),L(e,K),L(K,t),L(e,l),L(e,v),L(v,I),L(e,B),L(e,k),L(k,m),L(e,N)},p(b,q){q[0]&8&&r!==(r=b[36].code+"")&&ce(a,r),q[0]&8&&d!==(d=b[36].total+"")&&ce(o,d),q[0]&8&&g!==(g=b[36].empty+"")&&ce(h,g),q[0]&8&&H!==(H=b[36].percentComplete+"")&&ce(P,H),q[0]&8&&A!==(A=b[36].tooLong+"")&&ce(M,A),q[0]&8&&i!==(i=b[36].names+"")&&ce(t,i),q[0]&8&&w!==(w=b[36].macrons+"")&&ce(I,w),q[0]&8&&c!==(c=b[36].pronouns+"")&&ce(m,c)},d(b){b&&y(e)}}}function ft(n){let e,s,r,a,f,_,d,o=Me(n[4]),u=[];for(let p=0;p<o.length;p+=1)u[p]=ct(Ze(n,o,p));return{c(){e=T("div"),s=T("h2"),s.textContent="Errors:",r=j();for(let p=0;p<u.length;p+=1)u[p].c();a=j(),f=T("div"),f.textContent="START AGAIN",z(e,"class","error-text svelte-1itnntl"),z(f,"class","styled-button reset-button svelte-1itnntl")},m(p,g){C(p,e,g),L(e,s),L(e,r);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(e,null);C(p,a,g),C(p,f,g),_||(d=de(f,"click",n[12]),_=!0)},p(p,g){if(g[0]&16){o=Me(p[4]);let h;for(h=0;h<o.length;h+=1){const R=Ze(p,o,h);u[h]?u[h].p(R,g):(u[h]=ct(R),u[h].c(),u[h].m(e,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=o.length}},d(p){p&&(y(e),y(a),y(f)),We(u,p),_=!1,d()}}}function ct(n){let e,s=n[33]+"",r;return{c(){e=T("p"),r=ne(s),z(e,"class","svelte-1itnntl")},m(a,f){C(a,e,f),L(e,r)},p(a,f){f[0]&16&&s!==(s=a[33]+"")&&ce(r,s)},d(a){a&&y(e)}}}function Kt(n){let e,s,r,a,f,_,d,o,u,p=n[1]===""&&et(n),g=n[1]==="csv"&&tt(n),h=n[1]==="write"&&it(n),R=n[1]==="loading"&&st(),E=n[1]==="check"&&rt(n),H=n[1]==="report"&&at(n),P=n[4].length>0&&ft(n);return{c(){e=T("main"),s=T("h1"),s.textContent="COMMENT CHECKER",r=j(),p&&p.c(),a=j(),g&&g.c(),f=j(),h&&h.c(),_=j(),R&&R.c(),d=j(),E&&E.c(),o=j(),H&&H.c(),u=j(),P&&P.c(),z(e,"class","svelte-1itnntl")},m(S,F){C(S,e,F),L(e,s),L(e,r),p&&p.m(e,null),L(e,a),g&&g.m(e,null),L(e,f),h&&h.m(e,null),L(e,_),R&&R.m(e,null),L(e,d),E&&E.m(e,null),L(e,o),H&&H.m(e,null),L(e,u),P&&P.m(e,null)},p(S,F){S[1]===""?p?p.p(S,F):(p=et(S),p.c(),p.m(e,a)):p&&(p.d(1),p=null),S[1]==="csv"?g?g.p(S,F):(g=tt(S),g.c(),g.m(e,f)):g&&(g.d(1),g=null),S[1]==="write"?h?h.p(S,F):(h=it(S),h.c(),h.m(e,_)):h&&(h.d(1),h=null),S[1]==="loading"?R||(R=st(),R.c(),R.m(e,d)):R&&(R.d(1),R=null),S[1]==="check"?E?E.p(S,F):(E=rt(S),E.c(),E.m(e,o)):E&&(E.d(1),E=null),S[1]==="report"?H?H.p(S,F):(H=at(S),H.c(),H.m(e,u)):H&&(H.d(1),H=null),S[4].length>0?P?P.p(S,F):(P=ft(S),P.c(),P.m(e,null)):P&&(P.d(1),P=null)},i:we,o:we,d(S){S&&y(e),p&&p.d(),g&&g.d(),h&&h.d(),R&&R.d(),E&&E.d(),H&&H.d(),P&&P.d()}}}const Le="Student ID",ve="First Name",Ce="Last Name",fe="max comment",ue="Ako Group",Ke="Stu_Gender_Code";function zt(n,e,s){let r="";const a={11:["she","her","hers","she's"],21:["he","him","his","he's"],30:["she","her","hers","she's","he","him","his","he's"],31:["he","him","his","he's"],32:["she","her","hers","she's"],39:["she","her","hers","she's","he","him","his","he's"]};let f,_,d,o={},u=[],p,g=-1;const h=()=>{if(s(2,d=Ye.parse(_,{header:!0,skipEmptyLines:!0})),d.meta.fields.includes(Le)||u.push(`Can't find ${Le} column in the uploaded CSV.`),d.meta.fields.includes(ve)||u.push(`Can't find ${ve} column in the uploaded CSV.`),d.meta.fields.includes(Ce)||u.push(`Can't find ${Ce} column in the uploaded CSV.`),d.meta.fields.includes(fe)||u.push(`Can't find ${fe} column in the uploaded CSV.`),d.meta.fields.includes(ue)||u.push(`Can't find ${ue} column in the uploaded CSV.`),d.meta.fields.includes(Ke)||u.push(`Can't find ${Ke} column in the uploaded CSV.`),u.length>0){console.error(u);return}s(5,p=`Your CSV file looks good! Before we continue - ${d.data.length} comments have been found. Does that number sound right? If so, please press either <span class="highlight-3">Process Individually</span> to get suggestions on comments one by one, or <span class="highlight-blue">Process All</span> to get a report on all comments at once.`)},R=()=>{for(const[k,c]of d.data.entries())if(c[fe]!==""){const m=re(c[fe]);s(2,d.data[k].commentCharacterCount=c[fe].length,d),s(2,d.data[k].commentFragments=m,d),s(2,d.data[k].suggestions=[],d),s(2,d.data[k].rebuiltComment="",d)}else u.push(`The student ${c[ve]} ${c[Ce]} (ID: ${c[Le]}) is missing a comment from the teacher ${c[ue]}. Please return to KAMAR and fill in all comments, then download the file again and upload it here to continue.`)},E=()=>{for(const[k,c]of d.data.entries())if(c[ue]in o||s(3,o[c[ue]]={code:c[ue],total:0,suggestions:[],tooLong:0,empty:0,macrons:0,names:0,pronouns:0},o),s(3,o[c[ue]].total+=1,o),c[fe]!==""){const m=c[fe].length;m>1e3&&(s(3,o[c[ue]].tooLong+=1,o),o[c[ue]].suggestions.push({firstName:c[ve],lastName:c[Ce],id:c[Le],issue:"Comment over 1000 character limit",suggestion:"Reduce comment length"})),s(2,d.data[k].commentCharacterCount=m,d),c[fe].includes(c[ve])||(s(3,o[c[ue]].names+=1,o),o[c[ue]].suggestions.push({firstName:c[ve],lastName:c[Ce],id:c[Le],issue:"Comment missing student's name",suggestion:"Check for typos, ensure student's name is used"}));const N=re(c[fe]);for(let b=0;b<N.length;b++){const q=A(N[b],b,c[Ke]);if(q[0]!=="")switch(N[b]=q[0],o[c[ue]].suggestions.push({firstName:c[ve],lastName:c[Ce],id:c[Le],issue:q[4],suggestion:q[2]}),q[4]){case"macron":s(3,o[c[ue]].macrons+=1,o);break;case"pronoun":s(3,o[c[ue]].pronouns+=1,o);break}}s(2,d.data[k].commentFragments=N,d),s(2,d.data[k].rebuiltComment="",d)}else s(3,o[c[ue]].empty+=1,o),o[c[ue]].suggestions.push({firstName:c[ve],lastName:c[Ce],id:c[Le],issue:"Comment missing",suggestion:"Write a comment"});for(const k in o)s(3,o[k].percentComplete=Math.round((o[k].total-o[k].empty)/o[k].total*100),o);s(1,r="report"),console.log(o)},H=()=>{if(s(1,r="loading"),s(5,p=""),R(),u.length>0){console.error(u),s(1,r="blank");return}s(6,g=0),U(d.data[g],g),s(1,r="check")},P=()=>{s(1,r="loading"),s(5,p=""),E()},S=()=>{const k=Object.keys(o).map(q=>{let ee=o[q];return delete ee.suggestions,ee}),c=Ye.unparse(k),m=new Blob([c],{type:"text/csv;charset=utf-8"}),N=URL.createObjectURL(m),b=document.createElement("a");b.href=N,b.download="CommentReport.csv",b.click(),URL.revokeObjectURL(N)},F=()=>{const k=JSON.stringify(o),c=new Blob([k],{type:"application/json "}),m=URL.createObjectURL(c),N=document.createElement("a");N.href=m,N.download="CommentReport.json",N.click(),URL.revokeObjectURL(m)},U=(k,c)=>{for(let m=0;m<k.commentFragments.length;m++){const N=A(k.commentFragments[m],m);N[0]!==""&&(s(2,d.data[c].commentFragments[m]=N[0],d),d.data[c].suggestions.push({index:N[1],suggestion:N[2],level:N[3]}))}M(c)},A=(k,c,m)=>{if(!K(k))return["",c,void 0,0,void 0];let N=i(k);if(N!=="")return[N,c,`${k} - replace with ${N}`,3,"macron"];let b=t(k,m);return b!==""?[b,c,`${k} - replace with appropriate ${b}`,3,"pronoun"]:["",c,void 0,0,void 0]},M=k=>{for(let c of d.data[k].suggestions){let m="";switch(console.log(c.level),c.level){case 1:m="highlight-1";break;case 2:m="highlight-2";break;case 3:m="highlight-3";break;default:m=""}const N=`<span class="${m}">${d.data[k].commentFragments[c.index]}</span>`;s(2,d.data[k].commentFragments[c.index]=N,d),console.log(d.data[k].commentFragments[c.index])}s(2,d.data[k].rebuilt=d.data[k].commentFragments.join(""),d)},re=k=>{const c=/([\w\u00c0-\u017F']+|[.,:;?!-()"\s])/g;return k.match(c)||[]},K=k=>/[\w\u00c0-\u017F']+/.test(k),i=k=>{switch(k){case"akonga":return"ākonga";case"Akonga":return"Ākonga";case"kaiarahi":return"kaiārahi";case"Kaiarahi":return"Kaiārahi";case"maori":return"māori";case"Maori":return"Māori";case"matatu":return"matatū";case"Matatu":return"Matatū";case"tahuna":return"tāhuna";case"Tahuna":return"Tāhuna";default:return""}},t=(k,c)=>a[c].includes(k)?"pronoun":"",l=()=>{s(6,g++,g),U(d.data[g],g)},v=()=>{s(0,f=void 0),_=void 0,s(2,d=void 0),s(3,o={}),s(4,u=[]),s(5,p=void 0),s(6,g=-1),s(1,r="")},w=()=>{s(1,r="csv")},I=()=>{window.location.href="https://localhost:8085"};function B(){f=this.files,s(0,f)}return n.$$.update=()=>{if(n.$$.dirty[0]&1&&f){s(4,u=[]);const k=new FileReader;k.readAsText(f[0]),k.onload=c=>{_=c.target.result,h()}}},[f,r,d,o,u,p,g,H,P,S,F,l,v,w,I,B]}class qt extends Dt{constructor(e){super(),It(this,e,zt,Kt,bt,{},null,[-1,-1])}}new qt({target:document.getElementById("app")});
