var gt=Object.defineProperty;var _t=(n,e,s)=>e in n?gt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var Be=(n,e,s)=>(_t(n,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const _ of u.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function s(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerPolicy&&(u.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?u.credentials="include":a.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(a){if(a.ep)return;a.ep=!0;const u=s(a);fetch(a.href,u)}})();function Ce(){}function dt(n){return n()}function Je(){return Object.create(null)}function Te(n){n.forEach(dt)}function ht(n){return typeof n=="function"}function vt(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function bt(n){return Object.keys(n).length===0}function I(n,e){n.appendChild(e)}function y(n,e,s){n.insertBefore(e,s||null)}function b(n){n.parentNode&&n.parentNode.removeChild(n)}function We(n,e){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(e)}function T(n){return document.createElement(n)}function ne(n){return document.createTextNode(n)}function F(){return ne(" ")}function kt(){return ne("")}function ge(n,e,s,r){return n.addEventListener(e,s,r),()=>n.removeEventListener(e,s,r)}function H(n,e,s){s==null?n.removeAttribute(e):n.getAttribute(e)!==s&&n.setAttribute(e,s)}function yt(n){return Array.from(n.childNodes)}function fe(n,e){e=""+e,n.data!==e&&(n.data=e)}let xe;function Pe(n){xe=n}const Ne=[],Ge=[];let Fe=[];const Qe=[],Ct=Promise.resolve();let Ke=!1;function wt(){Ke||(Ke=!0,Ct.then(pt))}function qe(n){Fe.push(n)}const He=new Set;let Ie=0;function pt(){if(Ie!==0)return;const n=xe;do{try{for(;Ie<Ne.length;){const e=Ne[Ie];Ie++,Pe(e),Et(e.$$)}}catch(e){throw Ne.length=0,Ie=0,e}for(Pe(null),Ne.length=0,Ie=0;Ge.length;)Ge.pop()();for(let e=0;e<Fe.length;e+=1){const s=Fe[e];He.has(s)||(He.add(s),s())}Fe.length=0}while(Ne.length);for(;Qe.length;)Qe.pop()();Ke=!1,He.clear(),Pe(n)}function Et(n){if(n.fragment!==null){n.update(),Te(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(qe)}}function Rt(n){const e=[],s=[];Fe.forEach(r=>n.indexOf(r)===-1?e.push(r):s.push(r)),s.forEach(r=>r()),Fe=e}const Ot=new Set;function St(n,e){n&&n.i&&(Ot.delete(n),n.i(e))}function Me(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function At(n,e,s){const{fragment:r,after_update:a}=n.$$;r&&r.m(e,s),qe(()=>{const u=n.$$.on_mount.map(dt).filter(ht);n.$$.on_destroy?n.$$.on_destroy.push(...u):Te(u),n.$$.on_mount=[]}),a.forEach(qe)}function Tt(n,e){const s=n.$$;s.fragment!==null&&(Rt(s.after_update),Te(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function Lt(n,e){n.$$.dirty[0]===-1&&(Ne.push(n),wt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function It(n,e,s,r,a,u,_=null,h=[-1]){const o=xe;Pe(n);const p=n.$$={fragment:null,ctx:[],props:u,update:Ce,not_equal:a,bound:Je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:Je(),dirty:h,skip_bound:!1,root:e.target||o.$$.root};_&&_(p.root);let g=!1;if(p.ctx=s?s(n,e.props||{},(m,c,...w)=>{const R=w.length?w[0]:c;return p.ctx&&a(p.ctx[m],p.ctx[m]=R)&&(!p.skip_bound&&p.bound[m]&&p.bound[m](R),g&&Lt(n,m)),c}):[],p.update(),g=!0,Te(p.before_update),p.fragment=r?r(p.ctx):!1,e.target){if(e.hydrate){const m=yt(e.target);p.fragment&&p.fragment.l(m),m.forEach(b)}else p.fragment&&p.fragment.c();e.intro&&St(n.$$.fragment),At(n,e.target,e.anchor),pt()}Pe(o)}class Dt{constructor(){Be(this,"$$");Be(this,"$$set")}$destroy(){Tt(this,1),this.$destroy=Ce}$on(e,s){if(!ht(s))return Ce;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(s),()=>{const a=r.indexOf(s);a!==-1&&r.splice(a,1)}}$set(e){this.$$set&&!bt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Nt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Nt);var Ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var mt={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(n,e){(function(s,r){n.exports=r()})(Ft,function s(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},a=!r.document&&!!r.postMessage,u=r.IS_PAPA_WORKER||!1,_={},h=0,o={parse:function(i,t){var l=(t=t||{}).dynamicTyping||!1;if(O(l)&&(t.dynamicTypingFunction=l,l={}),t.dynamicTyping=l,t.transform=!!O(t.transform)&&t.transform,t.worker&&o.WORKERS_SUPPORTED){var k=function(){if(!o.WORKERS_SUPPORTED)return!1;var d=(P=r.URL||r.webkitURL||null,D=s.toString(),o.BLOB_URL||(o.BLOB_URL=P.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))),f=new r.Worker(d),P,D;return f.onmessage=L,f.id=h++,_[f.id]=f}();return k.userStep=t.step,k.userChunk=t.chunk,k.userComplete=t.complete,k.userError=t.error,t.step=O(t.step),t.chunk=O(t.chunk),t.complete=O(t.complete),t.error=O(t.error),delete t.worker,void k.postMessage({input:i,config:t,workerId:k.id})}var E=null;return o.NODE_STREAM_INPUT,typeof i=="string"?(i=function(d){return d.charCodeAt(0)===65279?d.slice(1):d}(i),E=t.download?new m(t):new w(t)):i.readable===!0&&O(i.read)&&O(i.on)?E=new R(t):(r.File&&i instanceof File||i instanceof Object)&&(E=new c(t)),E.stream(i)},unparse:function(i,t){var l=!1,k=!0,E=",",d=`\r
`,f='"',P=f+f,D=!1,v=null,K=!1;(function(){if(typeof t=="object"){if(typeof t.delimiter!="string"||o.BAD_DELIMITERS.filter(function(S){return t.delimiter.indexOf(S)!==-1}).length||(E=t.delimiter),(typeof t.quotes=="boolean"||typeof t.quotes=="function"||Array.isArray(t.quotes))&&(l=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(D=t.skipEmptyLines),typeof t.newline=="string"&&(d=t.newline),typeof t.quoteChar=="string"&&(f=t.quoteChar),typeof t.header=="boolean"&&(k=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");v=t.columns}t.escapeChar!==void 0&&(P=t.escapeChar+f),(typeof t.escapeFormulae=="boolean"||t.escapeFormulae instanceof RegExp)&&(K=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var C=new RegExp(M(f),"g");if(typeof i=="string"&&(i=JSON.parse(i)),Array.isArray(i)){if(!i.length||Array.isArray(i[0]))return Z(null,i,D);if(typeof i[0]=="object")return Z(v||Object.keys(i[0]),i,D)}else if(typeof i=="object")return typeof i.data=="string"&&(i.data=JSON.parse(i.data)),Array.isArray(i.data)&&(i.fields||(i.fields=i.meta&&i.meta.fields||v),i.fields||(i.fields=Array.isArray(i.data[0])?i.fields:typeof i.data[0]=="object"?Object.keys(i.data[0]):[]),Array.isArray(i.data[0])||typeof i.data[0]=="object"||(i.data=[i.data])),Z(i.fields||[],i.data||[],D);throw new Error("Unable to serialize unrecognized input");function Z(S,G,le){var X="";typeof S=="string"&&(S=JSON.parse(S)),typeof G=="string"&&(G=JSON.parse(G));var re=Array.isArray(S)&&0<S.length,ie=!Array.isArray(G[0]);if(re&&k){for(var se=0;se<S.length;se++)0<se&&(X+=E),X+=oe(S[se],se);0<G.length&&(X+=d)}for(var N=0;N<G.length;N++){var q=re?S.length:G[N].length,Q=!1,te=re?Object.keys(G[N]).length===0:G[N].length===0;if(le&&!re&&(Q=le==="greedy"?G[N].join("").trim()==="":G[N].length===1&&G[N][0].length===0),le==="greedy"&&re){for(var V=[],ae=0;ae<q;ae++){var $=ie?S[ae]:ae;V.push(G[N][$])}Q=V.join("").trim()===""}if(!Q){for(var J=0;J<q;J++){0<J&&!te&&(X+=E);var _e=re&&ie?S[J]:J;X+=oe(G[N][_e],J)}N<G.length-1&&(!le||0<q&&!te)&&(X+=d)}}return X}function oe(S,G){if(S==null)return"";if(S.constructor===Date)return JSON.stringify(S).slice(1,25);var le=!1;K&&typeof S=="string"&&K.test(S)&&(S="'"+S,le=!0);var X=S.toString().replace(C,P);return(le=le||l===!0||typeof l=="function"&&l(S,G)||Array.isArray(l)&&l[G]||function(re,ie){for(var se=0;se<ie.length;se++)if(-1<re.indexOf(ie[se]))return!0;return!1}(X,o.BAD_DELIMITERS)||-1<X.indexOf(E)||X.charAt(0)===" "||X.charAt(X.length-1)===" ")?f+X+f:X}}};if(o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!a&&!!r.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=A,o.ParserHandle=B,o.NetworkStreamer=m,o.FileStreamer=c,o.StringStreamer=w,o.ReadableStreamStreamer=R,r.jQuery){var p=r.jQuery;p.fn.parse=function(i){var t=i.config||{},l=[];return this.each(function(d){if(!(p(this).prop("tagName").toUpperCase()==="INPUT"&&p(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var f=0;f<this.files.length;f++)l.push({file:this.files[f],inputElem:this,instanceConfig:p.extend({},t)})}),k(),this;function k(){if(l.length!==0){var d,f,P,D,v=l[0];if(O(i.before)){var K=i.before(v.file,v.inputElem);if(typeof K=="object"){if(K.action==="abort")return d="AbortError",f=v.file,P=v.inputElem,D=K.reason,void(O(i.error)&&i.error({name:d},f,P,D));if(K.action==="skip")return void E();typeof K.config=="object"&&(v.instanceConfig=p.extend(v.instanceConfig,K.config))}else if(K==="skip")return void E()}var C=v.instanceConfig.complete;v.instanceConfig.complete=function(Z){O(C)&&C(Z,v.file,v.inputElem),E()},o.parse(v.file,v.instanceConfig)}else O(i.complete)&&i.complete()}function E(){l.splice(0,1),k()}}}function g(i){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var l=U(t);l.chunkSize=parseInt(l.chunkSize),t.step||t.chunk||(l.chunkSize=null),this._handle=new B(l),(this._handle.streamer=this)._config=l}).call(this,i),this.parseChunk=function(t,l){if(this.isFirstChunk&&O(this._config.beforeFirstChunk)){var k=this._config.beforeFirstChunk(t);k!==void 0&&(t=k)}this.isFirstChunk=!1,this._halted=!1;var E=this._partialLine+t;this._partialLine="";var d=this._handle.parse(E,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var f=d.meta.cursor;this._finished||(this._partialLine=E.substring(f-this._baseIndex),this._baseIndex=f),d&&d.data&&(this._rowCount+=d.data.length);var P=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(u)r.postMessage({results:d,workerId:o.WORKER_ID,finished:P});else if(O(this._config.chunk)&&!l){if(this._config.chunk(d,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);d=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(d.data),this._completeResults.errors=this._completeResults.errors.concat(d.errors),this._completeResults.meta=d.meta),this._completed||!P||!O(this._config.complete)||d&&d.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),P||d&&d.meta.paused||this._nextChunk(),d}this._halted=!0},this._sendError=function(t){O(this._config.error)?this._config.error(t):u&&this._config.error&&r.postMessage({workerId:o.WORKER_ID,error:t,finished:!1})}}function m(i){var t;(i=i||{}).chunkSize||(i.chunkSize=o.RemoteChunkSize),g.call(this,i),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(l){this._input=l,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),a||(t.onload=j(this._chunkLoaded,this),t.onerror=j(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var l=this._config.downloadRequestHeaders;for(var k in l)t.setRequestHeader(k,l[k])}if(this._config.chunkSize){var E=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+E)}try{t.send(this._config.downloadRequestBody)}catch(d){this._chunkError(d.message)}a&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(l){var k=l.getResponseHeader("Content-Range");return k===null?-1:parseInt(k.substring(k.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(l){var k=t.statusText||l;this._sendError(new Error(k))}}function c(i){var t,l;(i=i||{}).chunkSize||(i.chunkSize=o.LocalChunkSize),g.call(this,i);var k=typeof FileReader<"u";this.stream=function(E){this._input=E,l=E.slice||E.webkitSlice||E.mozSlice,k?((t=new FileReader).onload=j(this._chunkLoaded,this),t.onerror=j(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input;if(this._config.chunkSize){var d=Math.min(this._start+this._config.chunkSize,this._input.size);E=l.call(E,this._start,d)}var f=t.readAsText(E,this._config.encoding);k||this._chunkLoaded({target:{result:f}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(t.error)}}function w(i){var t;g.call(this,i=i||{}),this.stream=function(l){return t=l,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var l,k=this._config.chunkSize;return k?(l=t.substring(0,k),t=t.substring(k)):(l=t,t=""),this._finished=!t,this.parseChunk(l)}}}function R(i){g.call(this,i=i||{});var t=[],l=!0,k=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):l=!0},this._streamData=j(function(E){try{t.push(typeof E=="string"?E:E.toString(this._config.encoding)),l&&(l=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(d){this._streamError(d)}},this),this._streamError=j(function(E){this._streamCleanUp(),this._sendError(E)},this),this._streamEnd=j(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=j(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function B(i){var t,l,k,E=Math.pow(2,53),d=-E,f=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,P=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,D=this,v=0,K=0,C=!1,Z=!1,oe=[],S={data:[],errors:[],meta:{}};if(O(i.step)){var G=i.step;i.step=function(N){if(S=N,re())X();else{if(X(),S.data.length===0)return;v+=N.data.length,i.preview&&v>i.preview?l.abort():(S.data=S.data[0],G(S,D))}}}function le(N){return i.skipEmptyLines==="greedy"?N.join("").trim()==="":N.length===1&&N[0].length===0}function X(){return S&&k&&(se("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),k=!1),i.skipEmptyLines&&(S.data=S.data.filter(function(N){return!le(N)})),re()&&function(){if(!S)return;function N(Q,te){O(i.transformHeader)&&(Q=i.transformHeader(Q,te)),oe.push(Q)}if(Array.isArray(S.data[0])){for(var q=0;re()&&q<S.data.length;q++)S.data[q].forEach(N);S.data.splice(0,1)}else S.data.forEach(N)}(),function(){if(!S||!i.header&&!i.dynamicTyping&&!i.transform)return S;function N(Q,te){var V,ae=i.header?{}:[];for(V=0;V<Q.length;V++){var $=V,J=Q[V];i.header&&($=V>=oe.length?"__parsed_extra":oe[V]),i.transform&&(J=i.transform(J,$)),J=ie($,J),$==="__parsed_extra"?(ae[$]=ae[$]||[],ae[$].push(J)):ae[$]=J}return i.header&&(V>oe.length?se("FieldMismatch","TooManyFields","Too many fields: expected "+oe.length+" fields but parsed "+V,K+te):V<oe.length&&se("FieldMismatch","TooFewFields","Too few fields: expected "+oe.length+" fields but parsed "+V,K+te)),ae}var q=1;return!S.data.length||Array.isArray(S.data[0])?(S.data=S.data.map(N),q=S.data.length):S.data=N(S.data,0),i.header&&S.meta&&(S.meta.fields=oe),K+=q,S}()}function re(){return i.header&&oe.length===0}function ie(N,q){return Q=N,i.dynamicTypingFunction&&i.dynamicTyping[Q]===void 0&&(i.dynamicTyping[Q]=i.dynamicTypingFunction(Q)),(i.dynamicTyping[Q]||i.dynamicTyping)===!0?q==="true"||q==="TRUE"||q!=="false"&&q!=="FALSE"&&(function(te){if(f.test(te)){var V=parseFloat(te);if(d<V&&V<E)return!0}return!1}(q)?parseFloat(q):P.test(q)?new Date(q):q===""?null:q):q;var Q}function se(N,q,Q,te){var V={type:N,code:q,message:Q};te!==void 0&&(V.row=te),S.errors.push(V)}this.parse=function(N,q,Q){var te=i.quoteChar||'"';if(i.newline||(i.newline=function($,J){$=$.substring(0,1048576);var _e=new RegExp(M(J)+"([^]*?)"+M(J),"gm"),ce=($=$.replace(_e,"")).split("\r"),ve=$.split(`
`),be=1<ve.length&&ve[0].length<ce[0].length;if(ce.length===1||be)return`
`;for(var de=0,Y=0;Y<ce.length;Y++)ce[Y][0]===`
`&&de++;return de>=ce.length/2?`\r
`:"\r"}(N,te)),k=!1,i.delimiter)O(i.delimiter)&&(i.delimiter=i.delimiter(N),S.meta.delimiter=i.delimiter);else{var V=function($,J,_e,ce,ve){var be,de,Y,ee;ve=ve||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Se=0;Se<ve.length;Se++){var x=ve[Se],Le=0,ke=0,Ae=0;Y=void 0;for(var we=new A({comments:ce,delimiter:x,newline:J,preview:10}).parse($),Ee=0;Ee<we.data.length;Ee++)if(_e&&le(we.data[Ee]))Ae++;else{var Re=we.data[Ee].length;ke+=Re,Y!==void 0?0<Re&&(Le+=Math.abs(Re-Y),Y=Re):Y=Re}0<we.data.length&&(ke/=we.data.length-Ae),(de===void 0||Le<=de)&&(ee===void 0||ee<ke)&&1.99<ke&&(de=Le,be=x,ee=ke)}return{successful:!!(i.delimiter=be),bestDelimiter:be}}(N,i.newline,i.skipEmptyLines,i.comments,i.delimitersToGuess);V.successful?i.delimiter=V.bestDelimiter:(k=!0,i.delimiter=o.DefaultDelimiter),S.meta.delimiter=i.delimiter}var ae=U(i);return i.preview&&i.header&&ae.preview++,t=N,l=new A(ae),S=l.parse(t,q,Q),X(),C?{meta:{paused:!0}}:S||{meta:{paused:!1}}},this.paused=function(){return C},this.pause=function(){C=!0,l.abort(),t=O(i.chunk)?"":t.substring(l.getCharIndex())},this.resume=function(){D.streamer._halted?(C=!1,D.streamer.parseChunk(t,!0)):setTimeout(D.resume,3)},this.aborted=function(){return Z},this.abort=function(){Z=!0,l.abort(),S.meta.aborted=!0,O(i.complete)&&i.complete(S),t=""}}function M(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function A(i){var t,l=(i=i||{}).delimiter,k=i.newline,E=i.comments,d=i.step,f=i.preview,P=i.fastMode,D=t=i.quoteChar===void 0||i.quoteChar===null?'"':i.quoteChar;if(i.escapeChar!==void 0&&(D=i.escapeChar),(typeof l!="string"||-1<o.BAD_DELIMITERS.indexOf(l))&&(l=","),E===l)throw new Error("Comment character same as delimiter");E===!0?E="#":(typeof E!="string"||-1<o.BAD_DELIMITERS.indexOf(E))&&(E=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var v=0,K=!1;this.parse=function(C,Z,oe){if(typeof C!="string")throw new Error("Input must be a string");var S=C.length,G=l.length,le=k.length,X=E.length,re=O(d),ie=[],se=[],N=[],q=v=0;if(!C)return he();if(i.header&&!Z){var Q=C.split(k)[0].split(l),te=[],V={},ae=!1;for(var $ in Q){var J=Q[$];O(i.transformHeader)&&(J=i.transformHeader(J,$));var _e=J,ce=V[J]||0;for(0<ce&&(ae=!0,_e=J+"_"+ce),V[J]=ce+1;te.includes(_e);)_e=_e+"_"+ce;te.push(_e)}if(ae){var ve=C.split(k);ve[0]=te.join(l),C=ve.join(k)}}if(P||P!==!1&&C.indexOf(t)===-1){for(var be=C.split(k),de=0;de<be.length;de++){if(N=be[de],v+=N.length,de!==be.length-1)v+=k.length;else if(oe)return he();if(!E||N.substring(0,X)!==E){if(re){if(ie=[],Ae(N.split(l)),je(),K)return he()}else Ae(N.split(l));if(f&&f<=de)return ie=ie.slice(0,f),he(!0)}}return he()}for(var Y=C.indexOf(l,v),ee=C.indexOf(k,v),Se=new RegExp(M(D)+M(t),"g"),x=C.indexOf(t,v);;)if(C[v]!==t)if(E&&N.length===0&&C.substring(v,v+X)===E){if(ee===-1)return he();v=ee+le,ee=C.indexOf(k,v),Y=C.indexOf(l,v)}else if(Y!==-1&&(Y<ee||ee===-1))N.push(C.substring(v,Y)),v=Y+G,Y=C.indexOf(l,v);else{if(ee===-1)break;if(N.push(C.substring(v,ee)),Re(ee+le),re&&(je(),K))return he();if(f&&ie.length>=f)return he(!0)}else for(x=v,v++;;){if((x=C.indexOf(t,x+1))===-1)return oe||se.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ie.length,index:v}),Ee();if(x===S-1)return Ee(C.substring(v,x).replace(Se,t));if(t!==D||C[x+1]!==D){if(t===D||x===0||C[x-1]!==D){Y!==-1&&Y<x+1&&(Y=C.indexOf(l,x+1)),ee!==-1&&ee<x+1&&(ee=C.indexOf(k,x+1));var Le=we(ee===-1?Y:Math.min(Y,ee));if(C.substr(x+1+Le,G)===l){N.push(C.substring(v,x).replace(Se,t)),C[v=x+1+Le+G]!==t&&(x=C.indexOf(t,v)),Y=C.indexOf(l,v),ee=C.indexOf(k,v);break}var ke=we(ee);if(C.substring(x+1+ke,x+1+ke+le)===k){if(N.push(C.substring(v,x).replace(Se,t)),Re(x+1+ke+le),Y=C.indexOf(l,v),x=C.indexOf(t,v),re&&(je(),K))return he();if(f&&ie.length>=f)return he(!0);break}se.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ie.length,index:v}),x++}}else x++}return Ee();function Ae(pe){ie.push(pe),q=v}function we(pe){var Ve=0;if(pe!==-1){var Ue=C.substring(x+1,pe);Ue&&Ue.trim()===""&&(Ve=Ue.length)}return Ve}function Ee(pe){return oe||(pe===void 0&&(pe=C.substring(v)),N.push(pe),v=S,Ae(N),re&&je()),he()}function Re(pe){v=pe,Ae(N),N=[],ee=C.indexOf(k,v)}function he(pe){return{data:ie,errors:se,meta:{delimiter:l,linebreak:k,aborted:K,truncated:!!pe,cursor:q+(Z||0)}}}function je(){d(he()),ie=[],se=[]}},this.abort=function(){K=!0},this.getCharIndex=function(){return v}}function L(i){var t=i.data,l=_[t.workerId],k=!1;if(t.error)l.userError(t.error,t.file);else if(t.results&&t.results.data){var E={abort:function(){k=!0,W(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:z,resume:z};if(O(l.userStep)){for(var d=0;d<t.results.data.length&&(l.userStep({data:t.results.data[d],errors:t.results.errors,meta:t.results.meta},E),!k);d++);delete t.results}else O(l.userChunk)&&(l.userChunk(t.results,E,t.file),delete t.results)}t.finished&&!k&&W(t.workerId,t.results)}function W(i,t){var l=_[i];O(l.userComplete)&&l.userComplete(t),l.terminate(),delete _[i]}function z(){throw new Error("Not implemented.")}function U(i){if(typeof i!="object"||i===null)return i;var t=Array.isArray(i)?[]:{};for(var l in i)t[l]=U(i[l]);return t}function j(i,t){return function(){i.apply(t,arguments)}}function O(i){return typeof i=="function"}return u&&(r.onmessage=function(i){var t=i.data;if(o.WORKER_ID===void 0&&t&&(o.WORKER_ID=t.workerId),typeof t.input=="string")r.postMessage({workerId:o.WORKER_ID,results:o.parse(t.input,t.config),finished:!0});else if(r.File&&t.input instanceof File||t.input instanceof Object){var l=o.parse(t.input,t.config);l&&r.postMessage({workerId:o.WORKER_ID,results:l,finished:!0})}}),(m.prototype=Object.create(g.prototype)).constructor=m,(c.prototype=Object.create(g.prototype)).constructor=c,(w.prototype=Object.create(w.prototype)).constructor=w,(R.prototype=Object.create(g.prototype)).constructor=R,o})})(mt);var Pt=mt.exports;const Ye=Mt(Pt);function Ze(n,e,s){const r=n.slice();return r[33]=e[s],r}function Xe(n,e,s){const r=n.slice();return r[36]=e[s],r}function $e(n,e,s){const r=n.slice();return r[39]=e[s],r}function et(n){let e,s,r,a,u,_,h,o;return{c(){e=T("h2"),e.textContent="A tool to check your Kaiārahi comments.",s=F(),r=T("div"),a=T("div"),a.innerHTML='<h2>Upload Comments from KAMAR</h2> <p class="svelte-1itnntl">Export a .csv from PowerBI to process here.<br/> <strong>NOTE:</strong> this service is configured for Wakatipu High School specifically, and may not work with data from other schools.</p>',u=F(),_=T("div"),_.textContent="BACK",H(a,"class","tool-selector-button svelte-1itnntl"),H(r,"class","tool-selector-button-container svelte-1itnntl"),H(_,"class","styled-button back-button svelte-1itnntl")},m(p,g){y(p,e,g),y(p,s,g),y(p,r,g),I(r,a),y(p,u,g),y(p,_,g),h||(o=[ge(a,"click",n[12]),ge(_,"click",n[13])],h=!0)},p:Ce,d(p){p&&(b(e),b(s),b(r),b(u),b(_)),h=!1,Te(o)}}}function tt(n){let e,s,r,a,u,_,h,o,p,g,m,c,w,R,B,M,A,L,W,z,U=n[5]&&nt(n);return{c(){e=T("h3"),e.textContent="CSV format:",s=F(),r=T("table"),r.innerHTML='<thead><tr><th class="svelte-1itnntl">First Name</th> <th class="svelte-1itnntl">Last Name</th> <th class="svelte-1itnntl">Student ID</th> <th class="svelte-1itnntl">Current Year Level</th> <th class="svelte-1itnntl">Ako Group</th> <th class="svelte-1itnntl">Stu_Gender_Code</th> <th class="svelte-1itnntl">max comment</th></tr></thead> <tbody><tr><td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td></tr></tbody>',a=F(),u=T("p"),u.textContent='In order to get this CSV, download the PowerBI report called "Kaiārahi Comment Checking" and open it in PowerBI Desktop - the table there should reflect the columns listed above. Make sure the correct reports design(s) are selected in page filters - something similar to 3080 for Senior End of Year, 3088 and 3089 for Senior and Junior Midyear etc.',_=F(),h=T("p"),h.textContent="Once you've found the comments you're looking for, click the ··· menu button at the top right of the table, and click Export Data --> save as CSV.",o=F(),p=T("p"),p.innerHTML="<strong>This app will not work without a CSV file containing the above columns</strong>.",g=F(),m=T("input"),c=F(),U&&U.c(),w=F(),R=T("br"),B=F(),M=T("div"),M.innerHTML=`You can find the report design number by going to <strong>Reporting --&gt; Progress Reports</strong> in KAMAR. Select the Report Design that will contain the comment that you want to check, eg. &quot;Junior End of Year&quot;.<br/><br/>
      Click on the (i) button in the top right. Take note of the Report Design ID - put this number into the &quot;Report_Ref&quot; filter on the Kaiārahi Comment Checking page on PowerBI`,A=F(),L=T("div"),L.textContent="BACK",H(u,"class","svelte-1itnntl"),H(h,"class","svelte-1itnntl"),H(p,"class","svelte-1itnntl"),H(m,"type","file"),H(m,"name","csv-input"),H(m,"id","csv-input"),H(m,"accept",".csv"),H(m,"class","svelte-1itnntl"),H(M,"class","info-container svelte-1itnntl"),H(L,"class","styled-button back-button svelte-1itnntl")},m(j,O){y(j,e,O),y(j,s,O),y(j,r,O),y(j,a,O),y(j,u,O),y(j,_,O),y(j,h,O),y(j,o,O),y(j,p,O),y(j,g,O),y(j,m,O),y(j,c,O),U&&U.m(j,O),y(j,w,O),y(j,R,O),y(j,B,O),y(j,M,O),y(j,A,O),y(j,L,O),W||(z=[ge(m,"change",n[14]),ge(L,"click",n[11])],W=!0)},p(j,O){j[5]?U?U.p(j,O):(U=nt(j),U.c(),U.m(w.parentNode,w)):U&&(U.d(1),U=null)},d(j){j&&(b(e),b(s),b(r),b(a),b(u),b(_),b(h),b(o),b(p),b(g),b(m),b(c),b(w),b(R),b(B),b(M),b(A),b(L)),U&&U.d(j),W=!1,Te(z)}}}function nt(n){let e,s,r,a,u,_;return{c(){e=T("p"),s=F(),r=T("div"),a=T("input"),H(e,"class","svelte-1itnntl"),H(a,"type","button"),a.value="Process All",H(r,"class","submit-options")},m(h,o){y(h,e,o),e.innerHTML=n[5],y(h,s,o),y(h,r,o),I(r,a),u||(_=ge(a,"click",n[7]),u=!0)},p(h,o){o[0]&32&&(e.innerHTML=h[5])},d(h){h&&(b(e),b(s),b(r)),u=!1,_()}}}function it(n){let e,s,r,a,u;return{c(){e=T("p"),e.textContent="This tool is still being put together.",s=F(),r=T("div"),r.textContent="BACK",H(e,"class","svelte-1itnntl"),H(r,"class","styled-button back-button svelte-1itnntl")},m(_,h){y(_,e,h),y(_,s,h),y(_,r,h),a||(u=ge(r,"click",n[11]),a=!0)},p:Ce,d(_){_&&(b(e),b(s),b(r)),a=!1,u()}}}function st(n){let e;return{c(){e=T("h2"),e.textContent="LOADING..."},m(s,r){y(s,e,r)},d(s){s&&b(e)}}}function rt(n){let e;function s(u,_){return u[6]>=0&&u[6]<u[2].data.length?Ut:jt}let r=s(n),a=r(n);return{c(){a.c(),e=kt()},m(u,_){a.m(u,_),y(u,e,_)},p(u,_){r===(r=s(u))&&a?a.p(u,_):(a.d(1),a=r(u),a&&(a.c(),a.m(e.parentNode,e)))},d(u){u&&b(e),a.d(u)}}}function jt(n){let e,s,r;return{c(){e=T("div"),e.textContent="DONE",H(e,"class","styled-button back-button svelte-1itnntl")},m(a,u){y(a,e,u),s||(r=ge(e,"click",n[11]),s=!0)},p:Ce,d(a){a&&b(e),s=!1,r()}}}function Ut(n){let e,s,r,a=n[2].data[n[6]][ye]+"",u,_,h=n[2].data[n[6]][Oe]+"",o,p,g,m,c,w=n[2].data[n[6]][me]+"",R,B,M,A,L,W,z,U=n[2].data[n[6]][me].length>800&&ot(n);function j(t,l){return t[2].data[t[6]].suggestions.length>0?Ht:Bt}let O=j(n),i=O(n);return{c(){e=T("h2"),e.textContent="Student Name:",s=F(),r=T("p"),u=ne(a),_=F(),o=ne(h),p=F(),g=T("h2"),g.textContent="Original Comment:",m=F(),c=T("p"),R=ne(w),B=F(),U&&U.c(),M=F(),i.c(),A=F(),L=T("div"),L.textContent="NEXT",H(r,"class","svelte-1itnntl"),H(c,"class","svelte-1itnntl"),H(L,"class","styled-button next-button svelte-1itnntl")},m(t,l){y(t,e,l),y(t,s,l),y(t,r,l),I(r,u),I(r,_),I(r,o),y(t,p,l),y(t,g,l),y(t,m,l),y(t,c,l),I(c,R),y(t,B,l),U&&U.m(t,l),y(t,M,l),i.m(t,l),y(t,A,l),y(t,L,l),W||(z=ge(L,"click",n[10]),W=!0)},p(t,l){l[0]&68&&a!==(a=t[2].data[t[6]][ye]+"")&&fe(u,a),l[0]&68&&h!==(h=t[2].data[t[6]][Oe]+"")&&fe(o,h),l[0]&68&&w!==(w=t[2].data[t[6]][me]+"")&&fe(R,w),t[2].data[t[6]][me].length>800?U?U.p(t,l):(U=ot(t),U.c(),U.m(M.parentNode,M)):U&&(U.d(1),U=null),O===(O=j(t))&&i?i.p(t,l):(i.d(1),i=O(t),i&&(i.c(),i.m(A.parentNode,A)))},d(t){t&&(b(e),b(s),b(r),b(p),b(g),b(m),b(c),b(B),b(M),b(A),b(L)),U&&U.d(t),i.d(t),W=!1,z()}}}function ot(n){let e,s,r=n[2].data[n[6]][me].length+"",a,u;return{c(){e=T("p"),s=ne("This comment contains "),a=ne(r),u=ne(" characters - the maximum is 800. Please revise your comment, or part of it will be cut off on the report!"),H(e,"class","error-text svelte-1itnntl")},m(_,h){y(_,e,h),I(e,s),I(e,a),I(e,u)},p(_,h){h[0]&68&&r!==(r=_[2].data[_[6]][me].length+"")&&fe(a,r)},d(_){_&&b(e)}}}function Bt(n){let e;return{c(){e=T("p"),e.textContent="The words in this comment passed all tests.",H(e,"class","svelte-1itnntl")},m(s,r){y(s,e,r)},p:Ce,d(s){s&&b(e)}}}function Ht(n){let e,s,r,a,u,_,h=n[2].data[n[6]].commentFragments.join("")+"",o,p,g=Me(n[2].data[n[6]].suggestions),m=[];for(let c=0;c<g.length;c+=1)m[c]=lt($e(n,g,c));return{c(){e=T("h2"),e.textContent="Suggestions:",s=F();for(let c=0;c<m.length;c+=1)m[c].c();r=F(),a=T("h2"),a.textContent="Revised Comment:",u=F(),_=T("p"),o=F(),p=T("p"),p.textContent="Feel free to copy and paste this comment into KAMAR :D",H(_,"class","svelte-1itnntl"),H(p,"class","svelte-1itnntl")},m(c,w){y(c,e,w),y(c,s,w);for(let R=0;R<m.length;R+=1)m[R]&&m[R].m(c,w);y(c,r,w),y(c,a,w),y(c,u,w),y(c,_,w),_.innerHTML=h,y(c,o,w),y(c,p,w)},p(c,w){if(w[0]&68){g=Me(c[2].data[c[6]].suggestions);let R;for(R=0;R<g.length;R+=1){const B=$e(c,g,R);m[R]?m[R].p(B,w):(m[R]=lt(B),m[R].c(),m[R].m(r.parentNode,r))}for(;R<m.length;R+=1)m[R].d(1);m.length=g.length}w[0]&68&&h!==(h=c[2].data[c[6]].commentFragments.join("")+"")&&(_.innerHTML=h)},d(c){c&&(b(e),b(s),b(r),b(a),b(u),b(_),b(o),b(p)),We(m,c)}}}function lt(n){let e,s=n[39].suggestion+"",r;return{c(){e=T("p"),r=ne(s),H(e,"class","svelte-1itnntl")},m(a,u){y(a,e,u),I(e,r)},p(a,u){u[0]&68&&s!==(s=a[39].suggestion+"")&&fe(r,s)},d(a){a&&b(e)}}}function at(n){let e,s,r,a,u,_,h,o,p,g,m,c,w,R,B,M=Me(Object.values(n[3])),A=[];for(let L=0;L<M.length;L+=1)A[L]=ut(Xe(n,M,L));return{c(){e=T("h2"),e.textContent="REPORT",s=F(),r=T("div"),a=T("input"),u=F(),_=T("input"),h=F(),o=T("table"),p=T("thead"),p.innerHTML='<tr><th class="svelte-1itnntl">Teacher</th> <th class="svelte-1itnntl"># of Students</th> <th class="svelte-1itnntl">Comment Missing</th> <th class="svelte-1itnntl">% Complete</th> <th class="svelte-1itnntl">Too Long</th> <th class="svelte-1itnntl">Missing Name</th> <th class="svelte-1itnntl">Macron Suggestions</th> <th class="svelte-1itnntl">Incorrect Pronoun</th></tr>',g=F(),m=T("tbody");for(let L=0;L<A.length;L+=1)A[L].c();c=F(),w=T("div"),w.textContent="DONE",H(a,"type","button"),a.value="Download CSV",H(_,"type","button"),_.value="Download JSON",H(w,"class","styled-button back-button svelte-1itnntl")},m(L,W){y(L,e,W),y(L,s,W),y(L,r,W),I(r,a),I(r,u),I(r,_),y(L,h,W),y(L,o,W),I(o,p),I(o,g),I(o,m);for(let z=0;z<A.length;z+=1)A[z]&&A[z].m(m,null);y(L,c,W),y(L,w,W),R||(B=[ge(a,"click",n[8]),ge(_,"click",n[9]),ge(w,"click",n[11])],R=!0)},p(L,W){if(W[0]&8){M=Me(Object.values(L[3]));let z;for(z=0;z<M.length;z+=1){const U=Xe(L,M,z);A[z]?A[z].p(U,W):(A[z]=ut(U),A[z].c(),A[z].m(m,null))}for(;z<A.length;z+=1)A[z].d(1);A.length=M.length}},d(L){L&&(b(e),b(s),b(r),b(h),b(o),b(c),b(w)),We(A,L),R=!1,Te(B)}}}function ut(n){let e,s,r=n[36].code+"",a,u,_,h=n[36].total+"",o,p,g,m=n[36].empty+"",c,w,R,B=n[36].percentComplete+"",M,A,L,W,z=n[36].tooLong+"",U,j,O,i=n[36].names+"",t,l,k,E=n[36].macrons+"",d,f,P,D=n[36].pronouns+"",v,K;return{c(){e=T("tr"),s=T("td"),a=ne(r),u=F(),_=T("td"),o=ne(h),p=F(),g=T("td"),c=ne(m),w=F(),R=T("td"),M=ne(B),A=ne("%"),L=F(),W=T("td"),U=ne(z),j=F(),O=T("td"),t=ne(i),l=F(),k=T("td"),d=ne(E),f=F(),P=T("td"),v=ne(D),K=F()},m(C,Z){y(C,e,Z),I(e,s),I(s,a),I(e,u),I(e,_),I(_,o),I(e,p),I(e,g),I(g,c),I(e,w),I(e,R),I(R,M),I(R,A),I(e,L),I(e,W),I(W,U),I(e,j),I(e,O),I(O,t),I(e,l),I(e,k),I(k,d),I(e,f),I(e,P),I(P,v),I(e,K)},p(C,Z){Z[0]&8&&r!==(r=C[36].code+"")&&fe(a,r),Z[0]&8&&h!==(h=C[36].total+"")&&fe(o,h),Z[0]&8&&m!==(m=C[36].empty+"")&&fe(c,m),Z[0]&8&&B!==(B=C[36].percentComplete+"")&&fe(M,B),Z[0]&8&&z!==(z=C[36].tooLong+"")&&fe(U,z),Z[0]&8&&i!==(i=C[36].names+"")&&fe(t,i),Z[0]&8&&E!==(E=C[36].macrons+"")&&fe(d,E),Z[0]&8&&D!==(D=C[36].pronouns+"")&&fe(v,D)},d(C){C&&b(e)}}}function ft(n){let e,s,r,a,u,_,h,o=Me(n[4]),p=[];for(let g=0;g<o.length;g+=1)p[g]=ct(Ze(n,o,g));return{c(){e=T("div"),s=T("h2"),s.textContent="Errors:",r=F();for(let g=0;g<p.length;g+=1)p[g].c();a=F(),u=T("div"),u.textContent="START AGAIN",H(e,"class","error-text svelte-1itnntl"),H(u,"class","styled-button reset-button svelte-1itnntl")},m(g,m){y(g,e,m),I(e,s),I(e,r);for(let c=0;c<p.length;c+=1)p[c]&&p[c].m(e,null);y(g,a,m),y(g,u,m),_||(h=ge(u,"click",n[11]),_=!0)},p(g,m){if(m[0]&16){o=Me(g[4]);let c;for(c=0;c<o.length;c+=1){const w=Ze(g,o,c);p[c]?p[c].p(w,m):(p[c]=ct(w),p[c].c(),p[c].m(e,null))}for(;c<p.length;c+=1)p[c].d(1);p.length=o.length}},d(g){g&&(b(e),b(a),b(u)),We(p,g),_=!1,h()}}}function ct(n){let e,s=n[33]+"",r;return{c(){e=T("p"),r=ne(s),H(e,"class","svelte-1itnntl")},m(a,u){y(a,e,u),I(e,r)},p(a,u){u[0]&16&&s!==(s=a[33]+"")&&fe(r,s)},d(a){a&&b(e)}}}function zt(n){let e,s,r,a,u,_,h,o,p,g=n[1]===""&&et(n),m=n[1]==="csv"&&tt(n),c=n[1]==="write"&&it(n),w=n[1]==="loading"&&st(),R=n[1]==="check"&&rt(n),B=n[1]==="report"&&at(n),M=n[4].length>0&&ft(n);return{c(){e=T("main"),s=T("h1"),s.textContent="COMMENT CHECKER",r=F(),g&&g.c(),a=F(),m&&m.c(),u=F(),c&&c.c(),_=F(),w&&w.c(),h=F(),R&&R.c(),o=F(),B&&B.c(),p=F(),M&&M.c(),H(e,"class","svelte-1itnntl")},m(A,L){y(A,e,L),I(e,s),I(e,r),g&&g.m(e,null),I(e,a),m&&m.m(e,null),I(e,u),c&&c.m(e,null),I(e,_),w&&w.m(e,null),I(e,h),R&&R.m(e,null),I(e,o),B&&B.m(e,null),I(e,p),M&&M.m(e,null)},p(A,L){A[1]===""?g?g.p(A,L):(g=et(A),g.c(),g.m(e,a)):g&&(g.d(1),g=null),A[1]==="csv"?m?m.p(A,L):(m=tt(A),m.c(),m.m(e,u)):m&&(m.d(1),m=null),A[1]==="write"?c?c.p(A,L):(c=it(A),c.c(),c.m(e,_)):c&&(c.d(1),c=null),A[1]==="loading"?w||(w=st(),w.c(),w.m(e,h)):w&&(w.d(1),w=null),A[1]==="check"?R?R.p(A,L):(R=rt(A),R.c(),R.m(e,o)):R&&(R.d(1),R=null),A[1]==="report"?B?B.p(A,L):(B=at(A),B.c(),B.m(e,p)):B&&(B.d(1),B=null),A[4].length>0?M?M.p(A,L):(M=ft(A),M.c(),M.m(e,null)):M&&(M.d(1),M=null)},i:Ce,o:Ce,d(A){A&&b(e),g&&g.d(),m&&m.d(),c&&c.d(),w&&w.d(),R&&R.d(),B&&B.d(),M&&M.d()}}}const De="Student ID",ye="First Name",Oe="Last Name",me="max comment",ue="Ako Group",ze="Stu_Gender_Code";function Kt(n,e,s){let r="";const a={11:["she","her","hers","she's"],21:["he","him","his","he's"],30:["she","her","hers","she's","he","him","his","he's"],31:["he","him","his","he's"],32:["she","her","hers","she's"],39:["she","her","hers","she's","he","him","his","he's"]};let u,_,h,o={},p=[],g,m=-1;const c=()=>{if(s(2,h=Ye.parse(_,{header:!0,skipEmptyLines:!0})),h.meta.fields.includes(De)||p.push(`Can't find ${De} column in the uploaded CSV.`),h.meta.fields.includes(ye)||p.push(`Can't find ${ye} column in the uploaded CSV.`),h.meta.fields.includes(Oe)||p.push(`Can't find ${Oe} column in the uploaded CSV.`),h.meta.fields.includes(me)||p.push(`Can't find ${me} column in the uploaded CSV.`),h.meta.fields.includes(ue)||p.push(`Can't find ${ue} column in the uploaded CSV.`),h.meta.fields.includes(ze)||p.push(`Can't find ${ze} column in the uploaded CSV.`),p.length>0){console.error(p);return}s(5,g=`Your CSV file looks good! Before we continue - ${h.data.length} comments have been found. Does that number sound right? If so, please press either <span class="highlight-3">Process Individually</span> to get suggestions on comments one by one, or <span class="highlight-blue">Process All</span> to get a report on all comments at once.`)},w=()=>{for(const[d,f]of h.data.entries())if(f[ue]in o||s(3,o[f[ue]]={code:f[ue],total:0,suggestions:[],tooLong:0,empty:0,macrons:0,names:0,pronouns:0},o),s(3,o[f[ue]].total+=1,o),f[me]!==""){const P=f[me].length;P>1e3&&(s(3,o[f[ue]].tooLong+=1,o),o[f[ue]].suggestions.push({firstName:f[ye],lastName:f[Oe],id:f[De],issue:"Comment over 1000 character limit",suggestion:"Reduce comment length"})),s(2,h.data[d].commentCharacterCount=P,h),f[me].includes(f[ye])||(s(3,o[f[ue]].names+=1,o),o[f[ue]].suggestions.push({firstName:f[ye],lastName:f[Oe],id:f[De],issue:"Comment missing student's name",suggestion:"Check for typos, ensure student's name is used"}));const D=z(f[me]);for(let v=0;v<D.length;v++){const K=L(D[v],v,f[ze]);if(K[0]!=="")switch(D[v]=K[0],o[f[ue]].suggestions.push({firstName:f[ye],lastName:f[Oe],id:f[De],issue:K[4],suggestion:K[2]}),K[4]){case"macron":s(3,o[f[ue]].macrons+=1,o);break;case"pronoun":s(3,o[f[ue]].pronouns+=1,o);break}}s(2,h.data[d].commentFragments=D,h),s(2,h.data[d].rebuiltComment="",h)}else s(3,o[f[ue]].empty+=1,o),o[f[ue]].suggestions.push({firstName:f[ye],lastName:f[Oe],id:f[De],issue:"Comment missing",suggestion:"Write a comment"});for(const d in o)s(3,o[d].percentComplete=Math.round((o[d].total-o[d].empty)/o[d].total*100),o);s(1,r="report"),console.log(o)},R=()=>{s(1,r="loading"),s(5,g=""),w()},B=()=>{const d=Object.keys(o).map(K=>{let C=o[K];return delete C.suggestions,C}),f=Ye.unparse(d),P=new Blob([f],{type:"text/csv;charset=utf-8"}),D=URL.createObjectURL(P),v=document.createElement("a");v.href=D,v.download="CommentReport.csv",v.click(),URL.revokeObjectURL(D)},M=()=>{const d=JSON.stringify(o),f=new Blob([d],{type:"application/json "}),P=URL.createObjectURL(f),D=document.createElement("a");D.href=P,D.download="CommentReport.json",D.click(),URL.revokeObjectURL(P)},A=(d,f)=>{for(let P=0;P<d.commentFragments.length;P++){const D=L(d.commentFragments[P],P);D[0]!==""&&(s(2,h.data[f].commentFragments[P]=D[0],h),h.data[f].suggestions.push({index:D[1],suggestion:D[2],level:D[3]}))}W(f)},L=(d,f,P)=>{if(!U(d))return["",f,void 0,0,void 0];let D=j(d);if(D!=="")return[D,f,`${d} - replace with ${D}`,3,"macron"];let v=O(d,P);return v!==""?[v,f,`${d} - replace with appropriate ${v}`,3,"pronoun"]:["",f,void 0,0,void 0]},W=d=>{for(let f of h.data[d].suggestions){let P="";switch(console.log(f.level),f.level){case 1:P="highlight-1";break;case 2:P="highlight-2";break;case 3:P="highlight-3";break;default:P=""}const D=`<span class="${P}">${h.data[d].commentFragments[f.index]}</span>`;s(2,h.data[d].commentFragments[f.index]=D,h),console.log(h.data[d].commentFragments[f.index])}s(2,h.data[d].rebuilt=h.data[d].commentFragments.join(""),h)},z=d=>{const f=/([\w\u00c0-\u017F']+|[.,:;?!-()"\s])/g;return d.match(f)||[]},U=d=>/[\w\u00c0-\u017F']+/.test(d),j=d=>{switch(d){case"akonga":return"ākonga";case"Akonga":return"Ākonga";case"kaiarahi":return"kaiārahi";case"Kaiarahi":return"Kaiārahi";case"maori":return"māori";case"Maori":return"Māori";case"matatu":return"matatū";case"Matatu":return"Matatū";case"tahuna":return"tāhuna";case"Tahuna":return"Tāhuna";default:return""}},O=(d,f)=>a[f].includes(d)?"pronoun":"",i=()=>{s(6,m++,m),A(h.data[m],m)},t=()=>{s(0,u=void 0),_=void 0,s(2,h=void 0),s(3,o={}),s(4,p=[]),s(5,g=void 0),s(6,m=-1),s(1,r="")},l=()=>{s(1,r="csv")},k=()=>{window.location.href="https://localhost:8085"};function E(){u=this.files,s(0,u)}return n.$$.update=()=>{if(n.$$.dirty[0]&1&&u){s(4,p=[]);const d=new FileReader;d.readAsText(u[0]),d.onload=f=>{_=f.target.result,c()}}},[u,r,h,o,p,g,m,R,B,M,i,t,l,k,E]}class qt extends Dt{constructor(e){super(),It(this,e,Kt,zt,vt,{},null,[-1,-1])}}new qt({target:document.getElementById("app")});
